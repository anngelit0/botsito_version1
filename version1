import discord
from discord.ext import commands
import random
import asyncio

# Establecer permisos
permisos = discord.Intents.default()
permisos.message_content = True

# CreaciÃ³n del bot
bot = commands.Bot(command_prefix="$", intents=permisos)

# ------------------------------
# EVENTOS
# ------------------------------
@bot.event
async def on_ready():
    print("El bot estÃ¡ en lÃ­nea.")

@bot.command()
async def hola(ctx):
    await ctx.send(f"Hola, mi nombre es: {bot.user.name}")

# 1) Comando ROLL
@bot.command()
async def roll(ctx, dice: str):
    """Lanza dados en formato NdN (ej. 2d6)"""
    try:
        rolls, limit = map(int, dice.lower().split('d'))
    except Exception:
        await ctx.send("âš  Formato invÃ¡lido. Usa NdN, por ejemplo: 2d6")
        return

    resultados = [random.randint(1, limit) for _ in range(rolls)]
    await ctx.send(f"ğŸ² Resultados: {', '.join(map(str, resultados))}")

# 2) Comando GUESS
@bot.command()
async def guess(ctx):
    """Juego: Adivina el nÃºmero"""
    numero_secreto = random.randint(1, 10)
    await ctx.send("He pensado un nÃºmero entre 1 y 10. Â¡Adivina! (Escribe tu nÃºmero en el chat)")

    def check(m):
        return m.author == ctx.author and m.channel == ctx.channel and m.content.isdigit()

    try:
        intento = await bot.wait_for("message", check=check, timeout=15.0)
    except asyncio.TimeoutError:
        await ctx.send(f"â³ Tiempo agotado. El nÃºmero era {numero_secreto}.")
        return

    if int(intento.content) == numero_secreto:
        await ctx.send("ğŸ‰ Â¡Correcto! Adivinaste el nÃºmero.")
    else:
        await ctx.send(f"âŒ No era ese. El nÃºmero correcto era {numero_secreto}.")

# 3) Comando FACT (Historia)
# ------------------------------
datos_prehispanicos = [
    "ğŸŒ½ El maÃ­z fue domesticado en MesoamÃ©rica hace mÃ¡s de 9,000 aÃ±os a partir del teocintle.",
    "ğŸ—¿ Los olmecas crearon las primeras cabezas colosales hace mÃ¡s de 3,000 aÃ±os.",
    "ğŸ› La ciudad de TeotihuacÃ¡n fue una de las mÃ¡s grandes del mundo en su Ã©poca, con mÃ¡s de 100,000 habitantes.",
    "ğŸª¶ Los mexicas utilizaban plumas de quetzal como sÃ­mbolo de poder y riqueza.",
    "ğŸ“œ Los mayas desarrollaron un sistema de escritura jeroglÃ­fica Ãºnico en AmÃ©rica.",
    "ğŸŒ‹ El PopocatÃ©petl y el IztaccÃ­huatl forman parte de una leyenda prehispÃ¡nica de amor trÃ¡gico.",
    "ğŸ’ El jade era mÃ¡s valioso que el oro para muchas culturas mesoamericanas.",
    "ğŸŒŒ Los mayas tenÃ­an observatorios astronÃ³micos para predecir eclipses y movimientos planetarios.",
    "ğŸª¨ Los zapotecas crearon el calendario agrÃ­cola que influyÃ³ en otras culturas mesoamericanas.",
    "ğŸš Los mexicas usaban caracoles marinos como trompetas ceremoniales en rituales."
]

@bot.command()
async def fact(ctx):
    """EnvÃ­a un dato curioso sobre la historia prehispÃ¡nica de MÃ©xico"""
    await ctx.send(random.choice(datos_prehispanicos))

@bot.command()
async def opciones(ctx):
    """Muestra las funciones disponibles del bot"""
    comandos = bot.commands
    mensaje = "**MenÃº de funciones disponibles:**\n\n"
    for comando in comandos:
        if not comando.hidden:
            descripcion = comando.help if comando.help else "Sin descripciÃ³n."
            mensaje += f"**/{comando.name}** - {descripcion}\n"
    await ctx.send(mensaje)

# Ejecutar bot
bot.run(TOKEN)
